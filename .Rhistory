devtools::che
devtools::check()
cdm <- PatientProfiles::mockPatientProfiles(patient_size = 100,
drug_exposure_size = 100)
cdm <- CohortSymmetry::getCohortSequence(cdm = cdm,
indexTable = "cohort1",
markerTable = "cohort2",
combinationWindow = c(0, Inf))
res <- CohortSymmetry::getSequenceRatios(
cdm = cdm,
outcomeTable = "joined_cohorts")
gtResult <- formatSequenceSymmetry(res)
expect_true("gt_tbl" %in% (gtResult %>% class()))
res <- CohortSymmetry::getSequenceRatios(
cdm = cdm,
outcomeTable = "joined_cohorts")
gtResult <- formatSequenceSymmetry(res)
gtResult %>% class()
devtools::load_all(".")
expect_true("gt_tbl" %in% (gtResult %>% class()))
expect_true(all(colnames(gtResult$`_data`) %in%
c("Database name", "Index", "Marker", "Study population",
"Index first, N (%)", "Marker first, N (%)", "CSR (95% CI)",
"ASR (95% CI)")))
expect_no_error(gtResult <- formatSequenceSymmetry(res,
studyPopulation = FALSE))
expect_true(all(colnames(gtResult$`_data`) %in%
c("Database name", "Index", "Marker",
"Index first, N (%)", "Marker first, N (%)", "CSR (95% CI)",
"ASR (95% CI)")))
expect_no_error(
fxResult <- formatSequenceSymmetry(res,
type = "fx",
studyPopulation = FALSE,
indexName = FALSE,
.options = list(groupNameCol = "cdm_name"))
)
expect_true(all(colnames(fxResult$body$dataset) %in%
c("Database name", "Marker","Index first, N (%)",
"Marker first, N (%)", "CSR (95% CI)", "ASR (95% CI)")))
expect_equal(fxResult$body$dataset$`Database name`,
factor(c("PP_MOCK", NA, NA, NA)))
expect_no_error(
tibbleResult <- formatSequenceSymmetry(res,
type = "tibble",
studyPopulation = FALSE,
cdmName = FALSE)
)
expect_true(tibbleResult$Index[1] == "Cohort 1")
expect_true(tibbleResult$Marker[1] == "Cohort 3")
tibbleResult$Marker[1]
tibbleResult
tibbleResult$Marker %in% c("Cohort 1", "Cohort 2", "Cohort 3")
devtools::check()
CohortSymmetry::formatSequenceSymmetryOptions()
devtools::load_all(".")
CohortSymmetry::formatSequenceSymmetryOptions()
